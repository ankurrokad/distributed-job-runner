{
  "id": "b5ee228e-7203-4209-a078-907b1d8971de",
  "prevId": "29894a08-557a-478c-be77-ff57ba78ed68",
  "version": "5",
  "dialect": "pg",
  "tables": {
    "batch": {
      "name": "batch",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "raw_data": {
          "name": "raw_data",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "total_rows": {
          "name": "total_rows",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'PENDING'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "batch_created_at_idx": {
          "name": "batch_created_at_idx",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {}
    },
    "batch_chunk": {
      "name": "batch_chunk",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "batch_id": {
          "name": "batch_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "chunk_index": {
          "name": "chunk_index",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "start_row": {
          "name": "start_row",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "end_row": {
          "name": "end_row",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "total_rows": {
          "name": "total_rows",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "workflow_step_id": {
          "name": "workflow_step_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'PENDING'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "batch_chunk_idx": {
          "name": "batch_chunk_idx",
          "columns": [
            "batch_id"
          ],
          "isUnique": false
        },
        "batch_chunk_chunk_idx": {
          "name": "batch_chunk_chunk_idx",
          "columns": [
            "chunk_index"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "batch_chunk_batch_id_batch_id_fk": {
          "name": "batch_chunk_batch_id_batch_id_fk",
          "tableFrom": "batch_chunk",
          "tableTo": "batch",
          "columnsFrom": [
            "batch_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "batch_chunk_workflow_step_id_workflow_step_id_fk": {
          "name": "batch_chunk_workflow_step_id_workflow_step_id_fk",
          "tableFrom": "batch_chunk",
          "tableTo": "workflow_step",
          "columnsFrom": [
            "workflow_step_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {}
    },
    "error_row": {
      "name": "error_row",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "batch_id": {
          "name": "batch_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "row_index": {
          "name": "row_index",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "raw_data": {
          "name": "raw_data",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "error_row_batch_idx": {
          "name": "error_row_batch_idx",
          "columns": [
            "batch_id"
          ],
          "isUnique": false
        },
        "error_row_row_idx": {
          "name": "error_row_row_idx",
          "columns": [
            "row_index"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "error_row_batch_id_batch_id_fk": {
          "name": "error_row_batch_id_batch_id_fk",
          "tableFrom": "error_row",
          "tableTo": "batch",
          "columnsFrom": [
            "batch_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {}
    },
    "idempotency_key": {
      "name": "idempotency_key",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "owner": {
          "name": "owner",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "key": {
          "name": "key",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "resource_id": {
          "name": "resource_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "response": {
          "name": "response",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "used_at": {
          "name": "used_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "ttl": {
          "name": "ttl",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idempotency_created_at_idx": {
          "name": "idempotency_created_at_idx",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        },
        "idempotency_used_at_idx": {
          "name": "idempotency_used_at_idx",
          "columns": [
            "used_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "owner_key_unique": {
          "name": "owner_key_unique",
          "nullsNotDistinct": false,
          "columns": [
            "owner",
            "key"
          ]
        }
      }
    },
    "job_attempt": {
      "name": "job_attempt",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "job_id": {
          "name": "job_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "step_id": {
          "name": "step_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "attempt": {
          "name": "attempt",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "error": {
          "name": "error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "result": {
          "name": "result",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "finished_at": {
          "name": "finished_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "job_attempt_job_idx": {
          "name": "job_attempt_job_idx",
          "columns": [
            "job_id"
          ],
          "isUnique": false
        },
        "job_attempt_workflow_idx": {
          "name": "job_attempt_workflow_idx",
          "columns": [
            "workflow_id"
          ],
          "isUnique": false
        },
        "job_attempt_step_idx": {
          "name": "job_attempt_step_idx",
          "columns": [
            "step_id"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "job_attempt_workflow_id_workflow_id_fk": {
          "name": "job_attempt_workflow_id_workflow_id_fk",
          "tableFrom": "job_attempt",
          "tableTo": "workflow",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "job_attempt_step_id_workflow_step_id_fk": {
          "name": "job_attempt_step_id_workflow_step_id_fk",
          "tableFrom": "job_attempt",
          "tableTo": "workflow_step",
          "columnsFrom": [
            "step_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {}
    },
    "processed_row": {
      "name": "processed_row",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "batch_id": {
          "name": "batch_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "row_index": {
          "name": "row_index",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "data": {
          "name": "data",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "score": {
          "name": "score",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "risk_level": {
          "name": "risk_level",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "processed_row_batch_idx": {
          "name": "processed_row_batch_idx",
          "columns": [
            "batch_id"
          ],
          "isUnique": false
        },
        "processed_row_row_idx": {
          "name": "processed_row_row_idx",
          "columns": [
            "row_index"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "processed_row_batch_id_batch_id_fk": {
          "name": "processed_row_batch_id_batch_id_fk",
          "tableFrom": "processed_row",
          "tableTo": "batch",
          "columnsFrom": [
            "batch_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {}
    },
    "timer": {
      "name": "timer",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "type": {
          "name": "type",
          "type": "timer_type",
          "primaryKey": false,
          "notNull": true
        },
        "target_type": {
          "name": "target_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "target_id": {
          "name": "target_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "when": {
          "name": "when",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true
        },
        "payload": {
          "name": "payload",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "fired_at": {
          "name": "fired_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "attempts": {
          "name": "attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "max_attempts": {
          "name": "max_attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 3
        },
        "cancelled": {
          "name": "cancelled",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "timer_when_idx": {
          "name": "timer_when_idx",
          "columns": [
            "when"
          ],
          "isUnique": false
        },
        "timer_type_idx": {
          "name": "timer_type_idx",
          "columns": [
            "type"
          ],
          "isUnique": false
        },
        "timer_target_idx": {
          "name": "timer_target_idx",
          "columns": [
            "target_type",
            "target_id"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {}
    },
    "workflow": {
      "name": "workflow",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "tenant_id": {
          "name": "tenant_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "input": {
          "name": "input",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "state": {
          "name": "state",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "workflow_status",
          "primaryKey": false,
          "notNull": true,
          "default": "'PENDING'"
        },
        "current_step": {
          "name": "current_step",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "attempts": {
          "name": "attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "is_paused": {
          "name": "is_paused",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "created_by": {
          "name": "created_by",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "failed_at": {
          "name": "failed_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "deleted_at": {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "workflow_status_idx": {
          "name": "workflow_status_idx",
          "columns": [
            "status"
          ],
          "isUnique": false
        },
        "workflow_type_idx": {
          "name": "workflow_type_idx",
          "columns": [
            "type"
          ],
          "isUnique": false
        },
        "workflow_tenant_idx": {
          "name": "workflow_tenant_idx",
          "columns": [
            "tenant_id"
          ],
          "isUnique": false
        },
        "workflow_created_at_idx": {
          "name": "workflow_created_at_idx",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {}
    },
    "workflow_history": {
      "name": "workflow_history",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "event_type": {
          "name": "event_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "payload": {
          "name": "payload",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "meta": {
          "name": "meta",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "history_workflow_idx": {
          "name": "history_workflow_idx",
          "columns": [
            "workflow_id"
          ],
          "isUnique": false
        },
        "history_event_type_idx": {
          "name": "history_event_type_idx",
          "columns": [
            "event_type"
          ],
          "isUnique": false
        },
        "history_created_at_idx": {
          "name": "history_created_at_idx",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "workflow_history_workflow_id_workflow_id_fk": {
          "name": "workflow_history_workflow_id_workflow_id_fk",
          "tableFrom": "workflow_history",
          "tableTo": "workflow",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {}
    },
    "workflow_step": {
      "name": "workflow_step",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "step_index": {
          "name": "step_index",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "type": {
          "name": "type",
          "type": "step_type",
          "primaryKey": false,
          "notNull": true,
          "default": "'TASK'"
        },
        "parallel_group": {
          "name": "parallel_group",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "payload": {
          "name": "payload",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": true
        },
        "result": {
          "name": "result",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "step_status",
          "primaryKey": false,
          "notNull": true,
          "default": "'PENDING'"
        },
        "scheduled_at": {
          "name": "scheduled_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "next_run_at": {
          "name": "next_run_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        },
        "attempts": {
          "name": "attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "max_retries": {
          "name": "max_retries",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 3
        },
        "last_error": {
          "name": "last_error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "deleted_at": {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "step_workflow_idx": {
          "name": "step_workflow_idx",
          "columns": [
            "workflow_id"
          ],
          "isUnique": false
        },
        "step_status_idx": {
          "name": "step_status_idx",
          "columns": [
            "status"
          ],
          "isUnique": false
        },
        "step_scheduled_idx": {
          "name": "step_scheduled_idx",
          "columns": [
            "scheduled_at"
          ],
          "isUnique": false
        },
        "step_name_idx": {
          "name": "step_name_idx",
          "columns": [
            "name"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {
        "workflow_step_workflow_id_workflow_id_fk": {
          "name": "workflow_step_workflow_id_workflow_id_fk",
          "tableFrom": "workflow_step",
          "tableTo": "workflow",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "workflow_step_unique": {
          "name": "workflow_step_unique",
          "nullsNotDistinct": false,
          "columns": [
            "workflow_id",
            "step_index"
          ]
        }
      }
    }
  },
  "enums": {
    "step_status": {
      "name": "step_status",
      "values": {
        "PENDING": "PENDING",
        "IN_PROGRESS": "IN_PROGRESS",
        "SUCCESS": "SUCCESS",
        "FAILED": "FAILED",
        "SKIPPED": "SKIPPED"
      }
    },
    "step_type": {
      "name": "step_type",
      "values": {
        "TASK": "TASK",
        "SUBWORKFLOW": "SUBWORKFLOW",
        "TIMER": "TIMER"
      }
    },
    "timer_type": {
      "name": "timer_type",
      "values": {
        "DELAY": "DELAY",
        "RETRY": "RETRY",
        "TIMEOUT": "TIMEOUT",
        "SCHEDULE": "SCHEDULE"
      }
    },
    "workflow_status": {
      "name": "workflow_status",
      "values": {
        "PENDING": "PENDING",
        "RUNNING": "RUNNING",
        "SUCCESS": "SUCCESS",
        "FAILED": "FAILED",
        "CANCELLED": "CANCELLED"
      }
    }
  },
  "schemas": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}